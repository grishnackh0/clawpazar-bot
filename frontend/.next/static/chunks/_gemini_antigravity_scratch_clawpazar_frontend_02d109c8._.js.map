{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/lib/store.ts"],"sourcesContent":["// ClawPazar – Zustand State Management\n// Stores: auth, auction, chat, listings\n\nimport { create } from 'zustand';\nimport type { Listing, Auction, Bid, Negotiation, AgentTask } from './api';\n\n// ============================================================\n// 1. AUTH STORE\n// ============================================================\n\ninterface AuthState {\n    userId: string | null;\n    email: string | null;\n    displayName: string | null;\n    role: 'buyer' | 'seller' | 'admin' | null;\n    token: string | null;\n    isAuthenticated: boolean;\n    login: (token: string, user: { id: string; email: string; displayName: string; role: string }) => void;\n    logout: () => void;\n}\n\nexport const useAuth = create<AuthState>((set) => ({\n    userId: null,\n    email: null,\n    displayName: null,\n    role: null,\n    token: typeof window !== 'undefined' ? localStorage.getItem('cp_token') : null,\n    isAuthenticated: typeof window !== 'undefined' ? !!localStorage.getItem('cp_token') : false,\n\n    login: (token, user) => {\n        localStorage.setItem('cp_token', token);\n        set({\n            token,\n            userId: user.id,\n            email: user.email,\n            displayName: user.displayName,\n            role: user.role as AuthState['role'],\n            isAuthenticated: true,\n        });\n    },\n\n    logout: () => {\n        localStorage.removeItem('cp_token');\n        set({\n            token: null,\n            userId: null,\n            email: null,\n            displayName: null,\n            role: null,\n            isAuthenticated: false,\n        });\n    },\n}));\n\n// ============================================================\n// 2. AUCTION STORE (real-time via WebSocket)\n// ============================================================\n\ninterface AuctionState {\n    activeAuction: Auction | null;\n    bids: Bid[];\n    isConnected: boolean;\n    setAuction: (auction: Auction) => void;\n    addBid: (bid: Bid) => void;\n    updatePrice: (price: number, endsAt: string) => void;\n    setConnected: (connected: boolean) => void;\n    reset: () => void;\n}\n\nexport const useAuction = create<AuctionState>((set) => ({\n    activeAuction: null,\n    bids: [],\n    isConnected: false,\n\n    setAuction: (auction) => set({ activeAuction: auction }),\n\n    addBid: (bid) =>\n        set((state) => ({\n            bids: [bid, ...state.bids].slice(0, 50), // keep last 50\n        })),\n\n    updatePrice: (price, endsAt) =>\n        set((state) => ({\n            activeAuction: state.activeAuction\n                ? { ...state.activeAuction, current_price: price, ends_at: endsAt }\n                : null,\n        })),\n\n    setConnected: (connected) => set({ isConnected: connected }),\n\n    reset: () => set({ activeAuction: null, bids: [], isConnected: false }),\n}));\n\n// ============================================================\n// 3. CHAT STORE (agent conversation)\n// ============================================================\n\nexport interface ChatMessage {\n    id: string;\n    role: 'user' | 'agent';\n    content: string;\n    timestamp: Date;\n    type: 'text' | 'image' | 'voice' | 'task_card' | 'listing_preview';\n    metadata?: Record<string, unknown>;\n    agentStatus?: string;\n    isStreaming?: boolean;\n}\n\ninterface ChatState {\n    messages: ChatMessage[];\n    isAgentTyping: boolean;\n    agentStatus: string | null;\n    activeTask: AgentTask | null;\n    addMessage: (msg: ChatMessage) => void;\n    addAgentReply: (msg: ChatMessage) => void; // adds msg AND clears typing\n    deleteMessage: (id: string) => void;\n    setAgentTyping: (typing: boolean, status?: string) => void;\n    setActiveTask: (task: AgentTask | null) => void;\n    setInput: (text: string) => void;\n    clearChat: () => void;\n    getMessages: () => ChatMessage[];\n    streamAgentStart: (msg: ChatMessage) => void; // start streaming placeholder\n    updateLastAgentMessage: (content: string) => void; // update streaming content\n    finalizeStream: () => void; // mark streaming done\n}\n\nexport const useChat = create<ChatState>((set, get) => ({\n    messages: [],\n    isAgentTyping: false,\n    agentStatus: null,\n    activeTask: null,\n\n    // Add message WITHOUT touching typing state (for user messages)\n    addMessage: (msg) =>\n        set((state) => ({\n            messages: [...state.messages, msg],\n        })),\n\n    // Add agent reply AND clear typing indicator in one atomic update\n    addAgentReply: (msg) =>\n        set((state) => ({\n            messages: [...state.messages, msg],\n            isAgentTyping: false,\n            agentStatus: null,\n        })),\n\n    deleteMessage: (id) =>\n        set((state) => ({\n            messages: state.messages.filter((m) => m.id !== id),\n        })),\n\n    setAgentTyping: (typing, status) =>\n        set({ isAgentTyping: typing, agentStatus: status || null }),\n\n    setActiveTask: (task) => set({ activeTask: task }),\n\n    setInput: () => { },\n\n    // Getter for accessing messages outside React render (e.g. in async functions)\n    getMessages: () => get().messages,\n\n    // Start a streaming message placeholder\n    streamAgentStart: (msg) =>\n        set((state) => ({\n            messages: [...state.messages, { ...msg, isStreaming: true }],\n            isAgentTyping: false,\n            agentStatus: null,\n        })),\n\n    // Update the last agent message content (for streaming)\n    updateLastAgentMessage: (content) =>\n        set((state) => {\n            const msgs = [...state.messages];\n            for (let i = msgs.length - 1; i >= 0; i--) {\n                if (msgs[i].role === 'agent' && msgs[i].isStreaming) {\n                    msgs[i] = { ...msgs[i], content };\n                    break;\n                }\n            }\n            return { messages: msgs };\n        }),\n\n    // Mark streaming as complete\n    finalizeStream: () =>\n        set((state) => {\n            const msgs = state.messages.map((m) =>\n                m.isStreaming ? { ...m, isStreaming: false } : m\n            );\n            return { messages: msgs, isAgentTyping: false, agentStatus: null };\n        }),\n\n    clearChat: () => set({ messages: [], isAgentTyping: false, agentStatus: null, activeTask: null }),\n}));\n\n// ============================================================\n// 4. LISTINGS STORE\n// ============================================================\n\ninterface ListingsState {\n    listings: Listing[];\n    totalCount: number;\n    currentPage: number;\n    isLoading: boolean;\n    filters: {\n        category?: string;\n        search?: string;\n        minPrice?: number;\n        maxPrice?: number;\n        city?: string;\n        sort?: string;\n    };\n    setListings: (listings: Listing[], total: number) => void;\n    appendListings: (listings: Listing[]) => void;\n    setPage: (page: number) => void;\n    setFilters: (filters: Partial<ListingsState['filters']>) => void;\n    setLoading: (loading: boolean) => void;\n}\n\nexport const useListings = create<ListingsState>((set) => ({\n    listings: [],\n    totalCount: 0,\n    currentPage: 1,\n    isLoading: false,\n    filters: {},\n\n    setListings: (listings, total) => set({ listings, totalCount: total, currentPage: 1 }),\n\n    appendListings: (newListings) =>\n        set((state) => ({\n            listings: [...state.listings, ...newListings],\n            currentPage: state.currentPage + 1,\n        })),\n\n    setPage: (page) => set({ currentPage: page }),\n\n    setFilters: (filters) =>\n        set((state) => ({\n            filters: { ...state.filters, ...filters },\n            listings: [],\n            currentPage: 1,\n        })),\n\n    setLoading: (loading) => set({ isLoading: loading }),\n}));\n\n// ============================================================\n// HELPERS\n// ============================================================\n\n/** Format price as Turkish Lira */\nexport function formatPrice(amount: number): string {\n    return new Intl.NumberFormat('tr-TR', {\n        style: 'currency',\n        currency: 'TRY',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n    }).format(amount);\n}\n\n/** Format relative time in Turkish */\nexport function formatTimeAgo(date: string | Date): string {\n    const now = new Date();\n    const then = new Date(date);\n    const diffMs = now.getTime() - then.getTime();\n    const diffMin = Math.floor(diffMs / 60000);\n    const diffHour = Math.floor(diffMs / 3600000);\n    const diffDay = Math.floor(diffMs / 86400000);\n\n    if (diffMin < 1) return 'az önce';\n    if (diffMin < 60) return `${diffMin} dk önce`;\n    if (diffHour < 24) return `${diffHour} sa önce`;\n    if (diffDay < 7) return `${diffDay} gün önce`;\n    return then.toLocaleDateString('tr-TR', { day: 'numeric', month: 'short' });\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/lib/api.ts"],"sourcesContent":["// ClawPazar – Typed API Client\n// Wraps all 25+ backend endpoints with auth token injection\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || '';\n\ntype Method = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n\nasync function request<T>(method: Method, path: string, body?: object): Promise<T> {\n    const token = typeof window !== 'undefined'\n        ? localStorage.getItem('cp_token')\n        : null;\n\n    const res = await fetch(`${API_BASE}${path}`, {\n        method,\n        headers: {\n            'Content-Type': 'application/json',\n            ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: body ? JSON.stringify(body) : undefined,\n    });\n\n    if (!res.ok) {\n        const err = await res.json().catch(() => ({ error: res.statusText }));\n        throw new Error(err.error || `API Error: ${res.status}`);\n    }\n\n    return res.json();\n}\n\n// ============================================================\n// LISTINGS\n// ============================================================\n\nexport const listingsApi = {\n    browse: (params?: {\n        page?: number; limit?: number; category?: string;\n        search?: string; minPrice?: number; maxPrice?: number;\n        city?: string; sort?: string;\n    }) => {\n        const qs = new URLSearchParams();\n        if (params) {\n            Object.entries(params).forEach(([k, v]) => {\n                if (v !== undefined) qs.set(k, String(v));\n            });\n        }\n        return request<{\n            listings: Listing[]; total: number; page: number; limit: number;\n        }>('GET', `/api/listings?${qs}`);\n    },\n\n    get: (id: string) =>\n        request<Listing>('GET', `/api/listings/${id}`),\n\n    create: (message: string, images?: string[], channel = 'web') =>\n        request<{ taskId: string; status: string; message: string }>(\n            'POST', '/api/listings', { message, images, channel }\n        ),\n\n    update: (id: string, data: Partial<Listing>) =>\n        request<Listing>('PUT', `/api/listings/${id}`, data),\n\n    publish: (id: string) =>\n        request<Listing>('POST', `/api/listings/${id}/publish`),\n\n    delete: (id: string) =>\n        request<{ success: boolean }>('DELETE', `/api/listings/${id}`),\n\n    semanticSearch: (embedding: number[], limit = 10) =>\n        request<Listing[]>('POST', '/api/listings/search/semantic', { embedding, limit }),\n};\n\n// ============================================================\n// AUCTIONS\n// ============================================================\n\nexport const auctionsApi = {\n    list: () =>\n        request<Auction[]>('GET', '/api/auctions'),\n\n    create: (data: {\n        listingId: string; startingPrice: number;\n        reservePrice?: number; durationMinutes: number; minBidIncrement?: number;\n    }) =>\n        request<Auction>('POST', '/api/auctions', data),\n\n    bid: (auctionId: string, amount: number) =>\n        request<Bid>('POST', `/api/auctions/${auctionId}/bid`, { amount }),\n};\n\n// ============================================================\n// NEGOTIATIONS\n// ============================================================\n\nexport const negotiationsApi = {\n    start: (listingId: string, offerAmount: number) =>\n        request<Negotiation>('POST', '/api/negotiations', { listingId, offerAmount }),\n\n    counter: (id: string, amount: number) =>\n        request<Negotiation>('POST', `/api/negotiations/${id}/counter`, { amount }),\n\n    accept: (id: string) =>\n        request<Negotiation>('POST', `/api/negotiations/${id}/accept`),\n};\n\n// ============================================================\n// PAYMENTS\n// ============================================================\n\nexport const paymentsApi = {\n    initialize: (data: {\n        orderId: string; card: object;\n        buyer: object; shippingAddress: object; billingAddress: object;\n    }) =>\n        request<{ status: string; threeDSHtmlContent: string; paymentId: string }>(\n            'POST', '/api/payments/initialize', data\n        ),\n};\n\n// ============================================================\n// VENDORS\n// ============================================================\n\nexport const vendorsApi = {\n    register: (data: {\n        storeName: string; address: string; city: string;\n        district: string; identityNumber: string; iban: string;\n        subMerchantType?: string;\n    }) =>\n        request<{ vendor: object; iyzicoStatus: string }>(\n            'POST', '/api/vendors/register', data\n        ),\n};\n\n// ============================================================\n// COMPLIANCE\n// ============================================================\n\nexport const complianceApi = {\n    getDisclosure: () =>\n        request<{ title: string; content: string; version: string }>(\n            'GET', '/api/compliance/disclosure'\n        ),\n\n    recordConsent: (consentType: string, isGranted: boolean, version: string) =>\n        request<{ id: string }>('POST', '/api/compliance/consent', {\n            consentType, isGranted, consentTextVersion: version,\n        }),\n\n    getConsents: () =>\n        request<Record<string, boolean>>('GET', '/api/compliance/consents'),\n\n    requestDeletion: (reason: string) =>\n        request<{ requestId: string }>('POST', '/api/compliance/delete', { reason }),\n\n    exportData: () =>\n        request<object>('GET', '/api/compliance/export'),\n\n    reportTakedown: (data: {\n        listingId: string; reporterEmail: string;\n        reporterName: string; reason: string;\n    }) =>\n        request<{ requestId: string; deadline: string }>(\n            'POST', '/api/compliance/takedown', data\n        ),\n};\n\n// ============================================================\n// AGENTS\n// ============================================================\n\nexport const agentsApi = {\n    taskStatus: (taskId: string) =>\n        request<AgentTask>('GET', `/api/agents/tasks/${taskId}`),\n};\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface Listing {\n    id: string;\n    vendor_id: string;\n    title: string;\n    description: string;\n    price: number;\n    currency: string;\n    images: string[];\n    thumbnail_url: string;\n    category_id: string;\n    condition: string;\n    city: string;\n    status: string;\n    content_source: string;\n    requires_human_review: boolean;\n    view_count: number;\n    favorite_count: number;\n    created_at: string;\n    vendors?: { store_name: string; avg_rating: number; store_slug: string };\n    categories?: { name_tr: string; slug: string };\n}\n\nexport interface Auction {\n    id: string;\n    listing_id: string;\n    starting_price: number;\n    current_price: number;\n    reserve_price: number;\n    min_bid_increment: number;\n    bid_count: number;\n    highest_bidder_id: string;\n    status: string;\n    starts_at: string;\n    ends_at: string;\n    listings?: { title: string; thumbnail_url: string; price: number };\n}\n\nexport interface Bid {\n    id: string;\n    auction_id: string;\n    bidder_id: string;\n    amount: number;\n    is_winning: boolean;\n    created_at: string;\n}\n\nexport interface Negotiation {\n    id: string;\n    listing_id: string;\n    buyer_id: string;\n    seller_id: string;\n    initial_offer: number;\n    current_offer: number;\n    counter_offer: number | null;\n    agreed_price: number | null;\n    status: string;\n    round_count: number;\n}\n\nexport interface AgentTask {\n    id: string;\n    agentType: string;\n    taskType: string;\n    status: 'queued' | 'running' | 'completed' | 'failed';\n    result?: Record<string, unknown>;\n    error?: string;\n}\n"],"names":[],"mappings":"AAAA,+BAA+B;AAC/B,4DAA4D;;;;;;;;;;;;;;;;;AAE3C;AAAjB,MAAM,WAAW,6DAAmC;AAIpD,eAAe,QAAW,MAAc,EAAE,IAAY,EAAE,IAAa;IACjE,MAAM,QAAQ,uCACR,aAAa,OAAO,CAAC,cACrB;IAEN,MAAM,MAAM,MAAM,MAAM,AAAC,GAAa,OAAX,UAAgB,OAAL,OAAQ;QAC1C;QACA,SAAS;YACL,gBAAgB;YAChB,GAAI,QAAQ;gBAAE,eAAe,AAAC,UAAe,OAAN;YAAQ,IAAI,CAAC,CAAC;QACzD;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACxC;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACT,MAAM,MAAM,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;gBAAE,OAAO,IAAI,UAAU;YAAC,CAAC;QACnE,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,AAAC,cAAwB,OAAX,IAAI,MAAM;IACzD;IAEA,OAAO,IAAI,IAAI;AACnB;AAMO,MAAM,cAAc;IACvB,QAAQ,CAAC;QAKL,MAAM,KAAK,IAAI;QACf,IAAI,QAAQ;YACR,OAAO,OAAO,CAAC,QAAQ,OAAO,CAAC;oBAAC,CAAC,GAAG,EAAE;gBAClC,IAAI,MAAM,WAAW,GAAG,GAAG,CAAC,GAAG,OAAO;YAC1C;QACJ;QACA,OAAO,QAEJ,OAAO,AAAC,iBAAmB,OAAH;IAC/B;IAEA,KAAK,CAAC,KACF,QAAiB,OAAO,AAAC,iBAAmB,OAAH;IAE7C,QAAQ,SAAC,SAAiB;YAAmB,2EAAU;eACnD,QACI,QAAQ,iBAAiB;YAAE;YAAS;YAAQ;QAAQ;;IAG5D,QAAQ,CAAC,IAAY,OACjB,QAAiB,OAAO,AAAC,iBAAmB,OAAH,KAAM;IAEnD,SAAS,CAAC,KACN,QAAiB,QAAQ,AAAC,iBAAmB,OAAH,IAAG;IAEjD,QAAQ,CAAC,KACL,QAA8B,UAAU,AAAC,iBAAmB,OAAH;IAE7D,gBAAgB,SAAC;YAAqB,yEAAQ;eAC1C,QAAmB,QAAQ,iCAAiC;YAAE;YAAW;QAAM;;AACvF;AAMO,MAAM,cAAc;IACvB,MAAM,IACF,QAAmB,OAAO;IAE9B,QAAQ,CAAC,OAIL,QAAiB,QAAQ,iBAAiB;IAE9C,KAAK,CAAC,WAAmB,SACrB,QAAa,QAAQ,AAAC,iBAA0B,OAAV,WAAU,SAAO;YAAE;QAAO;AACxE;AAMO,MAAM,kBAAkB;IAC3B,OAAO,CAAC,WAAmB,cACvB,QAAqB,QAAQ,qBAAqB;YAAE;YAAW;QAAY;IAE/E,SAAS,CAAC,IAAY,SAClB,QAAqB,QAAQ,AAAC,qBAAuB,OAAH,IAAG,aAAW;YAAE;QAAO;IAE7E,QAAQ,CAAC,KACL,QAAqB,QAAQ,AAAC,qBAAuB,OAAH,IAAG;AAC7D;AAMO,MAAM,cAAc;IACvB,YAAY,CAAC,OAIT,QACI,QAAQ,4BAA4B;AAEhD;AAMO,MAAM,aAAa;IACtB,UAAU,CAAC,OAKP,QACI,QAAQ,yBAAyB;AAE7C;AAMO,MAAM,gBAAgB;IACzB,eAAe,IACX,QACI,OAAO;IAGf,eAAe,CAAC,aAAqB,WAAoB,UACrD,QAAwB,QAAQ,2BAA2B;YACvD;YAAa;YAAW,oBAAoB;QAChD;IAEJ,aAAa,IACT,QAAiC,OAAO;IAE5C,iBAAiB,CAAC,SACd,QAA+B,QAAQ,0BAA0B;YAAE;QAAO;IAE9E,YAAY,IACR,QAAgB,OAAO;IAE3B,gBAAgB,CAAC,OAIb,QACI,QAAQ,4BAA4B;AAEhD;AAMO,MAAM,YAAY;IACrB,YAAY,CAAC,SACT,QAAmB,OAAO,AAAC,qBAA2B,OAAP;AACvD","debugId":null}},
    {"offset": {"line": 346, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/lib/ws.ts"],"sourcesContent":["// ClawPazar – WebSocket Client\n// Auto-reconnecting WebSocket for auction rooms and real-time updates\n\ntype WsMessage = {\n    type: string;\n    [key: string]: unknown;\n};\n\ntype WsHandler = (message: WsMessage) => void;\n\nexport class ClawSocket {\n    private ws: WebSocket | null = null;\n    private url: string;\n    private handlers: Map<string, Set<WsHandler>> = new Map();\n    private reconnectAttempts = 0;\n    private maxReconnectAttempts = 10;\n    private reconnectDelay = 1000;\n    private heartbeatInterval: ReturnType<typeof setInterval> | null = null;\n    private isDestroyed = false;\n\n    constructor(baseUrl?: string) {\n        const wsBase = baseUrl || process.env.NEXT_PUBLIC_WS_URL || 'ws://localhost:4000';\n        this.url = `${wsBase}/ws`;\n    }\n\n    // ----------------------------------------------------------\n    // CONNECTION\n    // ----------------------------------------------------------\n\n    connect(params?: Record<string, string>): void {\n        if (this.isDestroyed) return;\n\n        const qs = params\n            ? '?' + new URLSearchParams(params).toString()\n            : '';\n\n        this.ws = new WebSocket(`${this.url}${qs}`);\n\n        this.ws.onopen = () => {\n            this.reconnectAttempts = 0;\n            this.startHeartbeat();\n            this.emit('connected', { type: 'connected' });\n        };\n\n        this.ws.onmessage = (event) => {\n            try {\n                const msg = JSON.parse(event.data) as WsMessage;\n                this.emit(msg.type, msg);\n                this.emit('*', msg); // wildcard listener\n            } catch {\n                // ignore malformed messages\n            }\n        };\n\n        this.ws.onclose = () => {\n            this.stopHeartbeat();\n            this.emit('disconnected', { type: 'disconnected' });\n            this.attemptReconnect(params);\n        };\n\n        this.ws.onerror = () => {\n            this.ws?.close();\n        };\n    }\n\n    disconnect(): void {\n        this.isDestroyed = true;\n        this.stopHeartbeat();\n        this.ws?.close();\n        this.ws = null;\n        this.handlers.clear();\n    }\n\n    // ----------------------------------------------------------\n    // AUCTION ROOMS\n    // ----------------------------------------------------------\n\n    joinAuction(auctionId: string, userId?: string): void {\n        this.disconnect();\n        this.isDestroyed = false;\n        this.connect({\n            auctionId,\n            ...(userId ? { userId } : {}),\n        });\n    }\n\n    leaveAuction(): void {\n        this.disconnect();\n    }\n\n    // ----------------------------------------------------------\n    // MESSAGING\n    // ----------------------------------------------------------\n\n    send(message: WsMessage): void {\n        if (this.ws?.readyState === WebSocket.OPEN) {\n            this.ws.send(JSON.stringify(message));\n        }\n    }\n\n    // ----------------------------------------------------------\n    // EVENT HANDLING\n    // ----------------------------------------------------------\n\n    on(eventType: string, handler: WsHandler): () => void {\n        if (!this.handlers.has(eventType)) {\n            this.handlers.set(eventType, new Set());\n        }\n        this.handlers.get(eventType)!.add(handler);\n\n        // Return unsubscribe function\n        return () => {\n            this.handlers.get(eventType)?.delete(handler);\n        };\n    }\n\n    private emit(eventType: string, message: WsMessage): void {\n        this.handlers.get(eventType)?.forEach((handler) => handler(message));\n    }\n\n    // ----------------------------------------------------------\n    // RECONNECTION\n    // ----------------------------------------------------------\n\n    private attemptReconnect(params?: Record<string, string>): void {\n        if (this.isDestroyed || this.reconnectAttempts >= this.maxReconnectAttempts) {\n            return;\n        }\n\n        this.reconnectAttempts++;\n        const delay = Math.min(\n            this.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1),\n            30000\n        );\n\n        setTimeout(() => {\n            if (!this.isDestroyed) {\n                this.connect(params);\n            }\n        }, delay);\n    }\n\n    // ----------------------------------------------------------\n    // HEARTBEAT\n    // ----------------------------------------------------------\n\n    private startHeartbeat(): void {\n        this.heartbeatInterval = setInterval(() => {\n            this.send({ type: 'ping' });\n        }, 25000);\n    }\n\n    private stopHeartbeat(): void {\n        if (this.heartbeatInterval) {\n            clearInterval(this.heartbeatInterval);\n            this.heartbeatInterval = null;\n        }\n    }\n\n    // ----------------------------------------------------------\n    // STATUS\n    // ----------------------------------------------------------\n\n    get isConnected(): boolean {\n        return this.ws?.readyState === WebSocket.OPEN;\n    }\n}\n\n// Singleton for app-wide use\nlet socketInstance: ClawSocket | null = null;\n\nexport function getSocket(): ClawSocket {\n    if (!socketInstance) {\n        socketInstance = new ClawSocket();\n    }\n    return socketInstance;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/components/CountdownTimer.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\n\ninterface CountdownTimerProps {\n    endsAt: string;\n    onExpired?: () => void;\n    size?: 'sm' | 'md' | 'lg';\n}\n\nexport function CountdownTimer({ endsAt, onExpired, size = 'md' }: CountdownTimerProps) {\n    const [timeLeft, setTimeLeft] = useState(getTimeLeft(endsAt));\n\n    const tick = useCallback(() => {\n        const left = getTimeLeft(endsAt);\n        setTimeLeft(left);\n        if (left.total <= 0) onExpired?.();\n    }, [endsAt, onExpired]);\n\n    useEffect(() => {\n        tick();\n        const interval = setInterval(tick, 1000);\n        return () => clearInterval(interval);\n    }, [tick]);\n\n    const isUrgent = timeLeft.total > 0 && timeLeft.total <= 30000; // last 30 seconds\n    const isExpired = timeLeft.total <= 0;\n\n    const sizeClasses = {\n        sm: 'text-sm gap-1',\n        md: 'text-xl gap-2',\n        lg: 'text-3xl gap-3',\n    }[size];\n\n    const blockClasses = {\n        sm: 'w-8 h-8 text-xs',\n        md: 'w-12 h-12 text-sm',\n        lg: 'w-16 h-16 text-lg',\n    }[size];\n\n    if (isExpired) {\n        return (\n            <div className=\"flex items-center gap-2 text-[var(--color-accent-error)]\">\n                <span className=\"text-lg\">⏰</span>\n                <span className=\"font-bold\">Süre Doldu!</span>\n            </div>\n        );\n    }\n\n    return (\n        <div className={`flex items-center ${sizeClasses} ${isUrgent ? 'animate-[countdown-pulse_0.5s_ease-in-out_infinite]' : ''}`}>\n            {timeLeft.hours > 0 && (\n                <TimeBlock value={timeLeft.hours} label=\"sa\" className={blockClasses} isUrgent={isUrgent} />\n            )}\n            <TimeBlock value={timeLeft.minutes} label=\"dk\" className={blockClasses} isUrgent={isUrgent} />\n            <TimeBlock value={timeLeft.seconds} label=\"sn\" className={blockClasses} isUrgent={isUrgent} />\n        </div>\n    );\n}\n\nfunction TimeBlock({\n    value, label, className, isUrgent,\n}: {\n    value: number; label: string; className: string; isUrgent: boolean;\n}) {\n    return (\n        <div className={`flex flex-col items-center justify-center rounded-xl font-mono font-bold ${className} ${isUrgent\n                ? 'bg-red-500/20 text-red-400 border border-red-500/30'\n                : 'bg-[var(--color-surface-elevated)] text-[var(--color-text-primary)] border border-white/5'\n            }`}>\n            <span>{String(value).padStart(2, '0')}</span>\n            <span className=\"text-[8px] font-normal text-[var(--color-text-muted)] -mt-0.5\">{label}</span>\n        </div>\n    );\n}\n\nfunction getTimeLeft(endsAt: string) {\n    const total = Math.max(0, new Date(endsAt).getTime() - Date.now());\n    return {\n        total,\n        hours: Math.floor(total / 3600000),\n        minutes: Math.floor((total % 3600000) / 60000),\n        seconds: Math.floor((total % 60000) / 1000),\n    };\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAUO,SAAS,eAAe,KAAuD;QAAvD,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,IAAI,EAAuB,GAAvD;;IAC3B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wOAAQ,EAAC,YAAY;IAErD,MAAM,OAAO,IAAA,2OAAW;4CAAC;YACrB,MAAM,OAAO,YAAY;YACzB,YAAY;YACZ,IAAI,KAAK,KAAK,IAAI,GAAG,sBAAA,gCAAA;QACzB;2CAAG;QAAC;QAAQ;KAAU;IAEtB,IAAA,yOAAS;oCAAC;YACN;YACA,MAAM,WAAW,YAAY,MAAM;YACnC;4CAAO,IAAM,cAAc;;QAC/B;mCAAG;QAAC;KAAK;IAET,MAAM,WAAW,SAAS,KAAK,GAAG,KAAK,SAAS,KAAK,IAAI,OAAO,kBAAkB;IAClF,MAAM,YAAY,SAAS,KAAK,IAAI;IAEpC,MAAM,cAAc;QAChB,IAAI;QACJ,IAAI;QACJ,IAAI;IACR,CAAC,CAAC,KAAK;IAEP,MAAM,eAAe;QACjB,IAAI;QACJ,IAAI;QACJ,IAAI;IACR,CAAC,CAAC,KAAK;IAEP,IAAI,WAAW;QACX,qBACI,4PAAC;YAAI,WAAU;;8BACX,4PAAC;oBAAK,WAAU;8BAAU;;;;;;8BAC1B,4PAAC;oBAAK,WAAU;8BAAY;;;;;;;;;;;;IAGxC;IAEA,qBACI,4PAAC;QAAI,WAAW,AAAC,qBAAmC,OAAf,aAAY,KAAyE,OAAtE,WAAW,wDAAwD;;YAClH,SAAS,KAAK,GAAG,mBACd,4PAAC;gBAAU,OAAO,SAAS,KAAK;gBAAE,OAAM;gBAAK,WAAW;gBAAc,UAAU;;;;;;0BAEpF,4PAAC;gBAAU,OAAO,SAAS,OAAO;gBAAE,OAAM;gBAAK,WAAW;gBAAc,UAAU;;;;;;0BAClF,4PAAC;gBAAU,OAAO,SAAS,OAAO;gBAAE,OAAM;gBAAK,WAAW;gBAAc,UAAU;;;;;;;;;;;;AAG9F;GAhDgB;KAAA;AAkDhB,SAAS,UAAU,KAIlB;QAJkB,EACf,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAGpC,GAJkB;IAKf,qBACI,4PAAC;QAAI,WAAW,AAAC,4EAAwF,OAAb,WAAU,KAGjG,OAHoG,WAC/F,wDACA;;0BAEN,4PAAC;0BAAM,OAAO,OAAO,QAAQ,CAAC,GAAG;;;;;;0BACjC,4PAAC;gBAAK,WAAU;0BAAiE;;;;;;;;;;;;AAG7F;MAdS;AAgBT,SAAS,YAAY,MAAc;IAC/B,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,IAAI,KAAK,QAAQ,OAAO,KAAK,KAAK,GAAG;IAC/D,OAAO;QACH;QACA,OAAO,KAAK,KAAK,CAAC,QAAQ;QAC1B,SAAS,KAAK,KAAK,CAAC,AAAC,QAAQ,UAAW;QACxC,SAAS,KAAK,KAAK,CAAC,AAAC,QAAQ,QAAS;IAC1C;AACJ","debugId":null}},
    {"offset": {"line": 673, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/components/AuctionRoom.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useCallback, useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Bot, Zap, Wifi, WifiOff, Clock, Trophy, Gavel } from 'lucide-react';\nimport { useAuction, formatPrice } from '@/lib/store';\nimport { auctionsApi, type Bid } from '@/lib/api';\nimport { getSocket } from '@/lib/ws';\nimport { CountdownTimer } from './CountdownTimer';\n\ninterface AuctionRoomProps {\n    auctionId: string;\n    userId?: string;\n}\n\nexport function AuctionRoom({ auctionId, userId }: AuctionRoomProps) {\n    const { activeAuction, bids, isConnected, setAuction, addBid, updatePrice, setConnected, reset } = useAuction();\n    const [bidAmount, setBidAmount] = useState('');\n    const [showConfetti, setShowConfetti] = useState(false);\n    const [lastBidFlash, setLastBidFlash] = useState(false);\n\n    useEffect(() => {\n        auctionsApi.list().then(auctions => {\n            const found = auctions.find(a => a.id === auctionId);\n            if (found) setAuction(found);\n        }).catch(console.error);\n        return () => reset();\n    }, [auctionId, setAuction, reset]);\n\n    useEffect(() => {\n        const socket = getSocket();\n        socket.joinAuction(auctionId, userId);\n\n        const unsubConnected = socket.on('connected', () => setConnected(true));\n        const unsubDisconnected = socket.on('disconnected', () => setConnected(false));\n\n        const unsubBid = socket.on('new_bid', (data) => {\n            addBid(data.bid as Bid);\n            updatePrice(data.currentPrice as number, data.endsAt as string);\n            setLastBidFlash(true);\n            setTimeout(() => setLastBidFlash(false), 600);\n        });\n\n        const unsubEnd = socket.on('auction_ended', () => {\n            setShowConfetti(true);\n        });\n\n        return () => {\n            unsubConnected();\n            unsubDisconnected();\n            unsubBid();\n            unsubEnd();\n            socket.leaveAuction();\n        };\n    }, [auctionId, userId, addBid, updatePrice, setConnected]);\n\n    const placeBid = useCallback(async (amount?: number) => {\n        const finalAmount = amount || parseFloat(bidAmount);\n        if (!finalAmount || !activeAuction) return;\n        try {\n            await auctionsApi.bid(auctionId, finalAmount);\n            setBidAmount('');\n        } catch (err) { console.error('Bid failed:', err); }\n    }, [auctionId, bidAmount, activeAuction]);\n\n    if (!activeAuction) {\n        return (\n            <div className=\"flex items-center justify-center h-full\">\n                <div className=\"flex gap-1.5\">\n                    {[0, 1, 2].map((i) => (\n                        <div key={i} className=\"h-3 w-3 rounded-full bg-[var(--neon-purple)]\" style={{ animation: `typing-dot 1.2s ease-in-out ${i * 0.2}s infinite` }} />\n                    ))}\n                </div>\n            </div>\n        );\n    }\n\n    const currentPrice = activeAuction.current_price;\n    const quickBids = [\n        { label: '+100 ₺', amount: currentPrice + 100 },\n        { label: '+500 ₺', amount: currentPrice + 500 },\n        { label: '+1K ₺', amount: currentPrice + 1000 },\n    ];\n\n    return (\n        <div className=\"flex flex-col h-full relative overflow-hidden retro-grid\">\n            {/* Background */}\n            <div className=\"absolute inset-0 pointer-events-none\">\n                <div className=\"absolute top-0 left-1/4 w-64 h-64 bg-[#6B00FF]/10 rounded-full blur-[100px]\" />\n                <div className=\"absolute bottom-1/4 right-0 w-48 h-48 bg-[#FF2D78]/8 rounded-full blur-[80px]\" />\n            </div>\n\n            {/* Header */}\n            <div className=\"glass border-b border-[var(--neon-purple)]/10 p-4 relative z-10\">\n                <div className=\"flex items-center justify-between mb-3\">\n                    <div className=\"live-badge rounded-full px-2.5 py-1 text-xs font-bold font-retro inline-flex items-center gap-1.5\">\n                        <span className=\"w-2 h-2 rounded-full bg-[var(--neon-pink)] animate-live-dot\" />\n                        CANLI MEZAT\n                    </div>\n                    <div className=\"flex items-center gap-2 text-xs text-[var(--color-text-muted)] font-retro\">\n                        {isConnected\n                            ? <><Wifi className=\"w-3 h-3 icon-green icon-neon\" strokeWidth={2} /> BAĞLI</>\n                            : <><WifiOff className=\"w-3 h-3 text-[var(--color-accent-error)]\" strokeWidth={2} /> BAĞLANIYOR...</>\n                        }\n                    </div>\n                </div>\n                <h2 className=\"text-lg font-bold text-[var(--color-text-primary)]\">{activeAuction.listings?.title || 'Mezat'}</h2>\n            </div>\n\n            {/* Price Display */}\n            <motion.div\n                className=\"text-center py-8 relative z-10\"\n                style={{ animation: lastBidFlash ? 'bid-flash 0.6s ease-out' : undefined }}\n            >\n                <div className=\"text-xs text-[var(--color-text-muted)] mb-2 font-retro flex items-center justify-center gap-1\">\n                    <Clock className=\"w-3 h-3\" strokeWidth={2} />\n                    GÜNCEL TEKLİF\n                </div>\n                <motion.div\n                    className=\"text-4xl font-[900] neon-text price font-retro\"\n                    style={{ fontFamily: 'var(--font-display)', filter: 'drop-shadow(0 0 20px rgba(107, 0, 255, 0.5))' }}\n                    key={currentPrice}\n                    initial={{ scale: 1.2, opacity: 0 }}\n                    animate={{ scale: 1, opacity: 1 }}\n                    transition={{ type: 'spring', stiffness: 300, damping: 20 }}\n                >\n                    {formatPrice(currentPrice)}\n                </motion.div>\n                <div className=\"mt-3\">\n                    <CountdownTimer endsAt={activeAuction.ends_at} />\n                </div>\n            </motion.div>\n\n            {/* Bid History */}\n            <div className=\"flex-1 overflow-y-auto px-4 space-y-2 relative z-10\">\n                <AnimatePresence>\n                    {bids.map((bid) => (\n                        <motion.div\n                            key={bid.id}\n                            className=\"neon-card p-3 flex items-center justify-between\"\n                            initial={{ opacity: 0, x: -20 }}\n                            animate={{ opacity: 1, x: 0 }}\n                            exit={{ opacity: 0, x: 20 }}\n                        >\n                            <span className=\"text-xs text-[var(--color-text-muted)] font-retro\">{bid.bidder_id?.slice(0, 8) || 'ANONIM'}</span>\n                            <span className=\"text-sm font-bold neon-text price font-retro\">{formatPrice(bid.amount)}</span>\n                        </motion.div>\n                    ))}\n                </AnimatePresence>\n            </div>\n\n            {/* Bid Controls */}\n            <div className=\"glass border-t border-[var(--neon-purple)]/10 p-4 pb-safe relative z-10\">\n                <div className=\"flex gap-2 mb-3\">\n                    {quickBids.map((qb) => (\n                        <motion.button\n                            key={qb.label}\n                            onClick={() => placeBid(qb.amount)}\n                            className=\"flex-1 neon-btn-cyan rounded-xl py-2.5 text-xs font-bold font-retro text-white vhs-glitch\"\n                            whileTap={{ scale: 0.93 }}\n                        >\n                            {qb.label}\n                        </motion.button>\n                    ))}\n                </div>\n                <div className=\"flex gap-2\">\n                    <div className=\"flex-1 rounded-xl bg-[var(--color-surface-base)] border border-[var(--neon-purple)]/15 px-4 py-2.5 focus-within:border-[var(--neon-cyan)]/40 focus-within:shadow-[0_0_16px_rgba(0,240,255,0.1)] transition-all\">\n                        <input\n                            type=\"number\"\n                            value={bidAmount}\n                            onChange={(e) => setBidAmount(e.target.value)}\n                            placeholder=\"Teklif tutarı ₺\"\n                            className=\"w-full bg-transparent text-sm text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none price font-retro\"\n                        />\n                    </div>\n                    <motion.button\n                        onClick={() => placeBid()}\n                        className=\"neon-btn rounded-xl px-5 text-sm font-bold text-white flex items-center gap-1.5\"\n                        whileTap={{ scale: 0.93 }}\n                    >\n                        <Gavel className=\"w-4 h-4\" strokeWidth={2} />\n                        <span className=\"font-retro\">TEKLİF</span>\n                    </motion.button>\n                </div>\n            </div>\n\n            {/* Confetti */}\n            <AnimatePresence>\n                {showConfetti && (\n                    <motion.div className=\"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}>\n                        <motion.div className=\"text-center\" initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ type: 'spring', stiffness: 200 }}>\n                            <Trophy className=\"w-16 h-16 mx-auto text-[var(--neon-orange)] icon-neon mb-4\" strokeWidth={1} />\n                            <h2 className=\"text-2xl font-bold neon-text font-retro\" style={{ fontFamily: 'var(--font-display)' }}>MEZAT BİTTİ!</h2>\n                            <p className=\"text-sm text-[var(--color-text-secondary)] mt-2\">Kazanan belirlendi</p>\n                        </motion.div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1227, "column": 0}, "map": {"version":3,"sources":["file:///Users/taha/.gemini/antigravity/scratch/clawpazar/frontend/app/mezat/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useParams } from 'next/navigation';\nimport Link from 'next/link';\nimport { useAuth } from '@/lib/store';\nimport { AuctionRoom } from '@/components/AuctionRoom';\n\nexport default function LiveAuctionPage() {\n    const params = useParams();\n    const auctionId = params?.id as string;\n    const { userId } = useAuth();\n\n    return (\n        <div className=\"flex flex-col h-dvh\">\n            {/* Header */}\n            <div className=\"flex items-center gap-3 px-4 pt-12 pb-3 border-b border-white/5 glass\">\n                <Link\n                    href=\"/mezat\"\n                    className=\"flex h-9 w-9 items-center justify-center rounded-full bg-[var(--color-surface-elevated)] border border-white/5 transition-all active:scale-90\"\n                >\n                    ←\n                </Link>\n                <h1 className=\"text-sm font-bold flex-1\">🔨 Canlı Mezat</h1>\n                <div className=\"flex items-center gap-1\">\n                    <span className=\"h-2 w-2 rounded-full bg-red-400 animate-pulse\" />\n                    <span className=\"text-[10px] font-medium text-red-400\">CANLI</span>\n                </div>\n            </div>\n\n            {/* Auction Room */}\n            <div className=\"flex-1 overflow-hidden\">\n                <AuctionRoom\n                    auctionId={auctionId}\n                    userId={userId || undefined}\n                />\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAOe,SAAS;;IACpB,MAAM,SAAS,IAAA,iNAAS;IACxB,MAAM,YAAY,mBAAA,6BAAA,OAAQ,EAAE;IAC5B,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,yLAAO;IAE1B,qBACI,4PAAC;QAAI,WAAU;;0BAEX,4PAAC;gBAAI,WAAU;;kCACX,4PAAC,yOAAI;wBACD,MAAK;wBACL,WAAU;kCACb;;;;;;kCAGD,4PAAC;wBAAG,WAAU;kCAA2B;;;;;;kCACzC,4PAAC;wBAAI,WAAU;;0CACX,4PAAC;gCAAK,WAAU;;;;;;0CAChB,4PAAC;gCAAK,WAAU;0CAAuC;;;;;;;;;;;;;;;;;;0BAK/D,4PAAC;gBAAI,WAAU;0BACX,cAAA,4PAAC,2MAAW;oBACR,WAAW;oBACX,QAAQ,UAAU;;;;;;;;;;;;;;;;;AAKtC;GA/BwB;;QACL,iNAAS;QAEL,yLAAO;;;KAHN","debugId":null}}]
}